<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>HomeWizard Online API</title>
  <meta name="description" content="A while back I wrote about the HomeWizard API for when the HomeWizard is located inside your current network. That post is still up-to-date but it has one pr...">

  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/main.css">
  
<!--  <link rel="stylesheet" href="/css/main.css"> -->
  <link rel="canonical" href="http://cocoa.ninja/posts/HomeWizard-Online-API">
  <link rel="alternate" type="application/rss+xml" title="cocoa.ninja" href="http://cocoa.ninja/feed.xml" />
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
		<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>	    
      <a class="navbar-brand" href="/">
         cocoa.ninja
      </a>
    </div>
  
	  <div class="collapse navbar-collapse">
	      <ul class="nav navbar-nav navbar-right">
		      <li>
			  	<a href="https://twitter.com/depl0y">
					<img src="/img/svg/twitter.svg">
				</a>
	        
			</li>
	     
			<li class="icon  icon--github">
				<a href="https://github.com/depl0y">
					<img src="/img/svg/github.svg">
				</a>
			</li>	 
		
		
			<li class="icon icon--mail">
				<a href="mailto:wim@sortedbits.com">
					<img src="/img/svg/mail.svg">
				</a>
			</li>
			
			<li class="icon icon--so">
				<a href="http://stackoverflow.com/users/69313/wim-haanstra">
					<img src="/img/svg/stackoverflow.svg">
				</a>
			</li>
			
			
			<li class="icon icon--so">
				<a href="skype:wimhaanstra" id="skype_call_wim">
					<img src="/img/svg/skype.svg">
				</a>
			</li>
	  	</ul>
	  </div>
  </div>
</nav>


    <div class="container">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">HomeWizard Online API</h1>
  </header>
</div>

<div class="post-info">
	<div class="author-avatar">
		<img src="http://www.gravatar.com/avatar/0ec84fc5efb4f0dc7db5df8bf6bb41b9.png">
	</div>
	<div class="details">
		<div class="row">
			<div class="col-md-12 author-name">
				Wim Haanstra
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 post-subtitle">
				This post was created on <span class="post-date">April 22, 2015</span>.
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 tags">
		   		
		   			<span class="tag">swift</span>
		   		
		   			<span class="tag">homewizard</span>
		   		
		   			<span class="tag">homehandler</span>
		   		
			</div>
		</div>
	</div>
</div>


<div class="post">
  <article class="post-content">
    
<p>A <strong>while</strong> back I wrote about the <a href="http://cocoa.ninja/posts/HomeWizard-API-calls/">HomeWizard API</a> for when the HomeWizard is located inside your current network. That post is still up-to-date but it has one problem. You canâ€™t control your devices from outside of your home.</p>

<p>So now I did some network sniffing and I figured out how to control your HomeWizard from outside your own network (as long as you have a HomeWizard Online account).</p>

<!-- more -->

<p>What you need to login to a HWO account, you need an <strong>email address</strong> and a <strong>password</strong> and perform a generic <code>GET</code> request on <code>https://cloud.homewizard.com/account/login</code>. The password needs to be hashed to a SHA1 hash (in lowercase!) and <strong>Basic authentication</strong> should be used.</p>

<p>Here is an example written in Swift, using AFNetworking:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="lineno"> 1</span> <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">&quot;https://cloud.homewizard.com/account/login&quot;</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span> <span class="kd">let</span> <span class="nx">manager</span> <span class="o">=</span> <span class="nx">AFHTTPRequestOperationManager</span><span class="p">()</span>
<span class="lineno"> 4</span> <span class="nx">manager</span><span class="p">.</span><span class="nx">requestSerializer</span> <span class="o">=</span> <span class="nx">AFHTTPRequestSerializer</span><span class="p">()</span>
<span class="lineno"> 5</span> <span class="nx">manager</span><span class="p">.</span><span class="nx">requestSerializer</span><span class="p">.</span><span class="nx">setAuthorizationHeaderFieldWithUsername</span><span class="p">(</span><span class="nx">emailAddress</span><span class="p">,</span> <span class="nx">password</span><span class="o">:</span> <span class="nx">hashedPassword</span><span class="p">.</span><span class="nx">lowercaseString</span><span class="p">);</span>
<span class="lineno"> 6</span> <span class="nx">manager</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">parameters</span><span class="o">:</span> <span class="nx">nil</span><span class="p">,</span> <span class="nx">success</span><span class="o">:</span> <span class="p">{</span> <span class="p">(</span><span class="nx">operation</span><span class="o">:</span> <span class="nx">AFHTTPRequestOperation</span><span class="o">!</span><span class="p">,</span><span class="nx">responseObject</span><span class="o">:</span> <span class="nx">AnyObject</span><span class="o">!</span><span class="p">)</span> <span class="k">in</span>
<span class="lineno"> 7</span>     <span class="nx">DDLogVerbose</span><span class="p">(</span><span class="s2">&quot;\(responseObject)&quot;</span><span class="p">)</span>
<span class="lineno"> 8</span> <span class="p">},</span>
<span class="lineno"> 9</span> <span class="nx">failure</span><span class="o">:</span> <span class="p">{</span> <span class="p">(</span><span class="nx">operation</span><span class="o">:</span> <span class="nx">AFHTTPRequestOperation</span><span class="o">!</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span> <span class="nx">NSError</span><span class="o">!</span><span class="p">)</span> <span class="k">in</span>
<span class="lineno">10</span>     <span class="nx">DDLogError</span><span class="p">(</span><span class="s2">&quot;Error: \(error.localizedDescription)&quot;</span><span class="p">)</span>
<span class="lineno">11</span> <span class="p">})</span></code></pre></div>

<p>The <code>hashedPassword</code> variable mentioned in the code is the password of your HWO account, hashed using the SHA1 algorithm. I use <a href="https://github.com/krzyzanowskim/CryptoSwift">CryptoSwift</a> for this.</p>

<p>This request will return a response, which includes some valuable information:</p>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="lineno"> 1</span> <span class="p">{</span>
<span class="lineno"> 2</span>     <span class="nt">&quot;session&quot;</span><span class="p">:</span> <span class="s2">&quot;[sessionid]&quot;</span><span class="p">,</span>
<span class="lineno"> 3</span>     <span class="nt">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;[email address]&quot;</span><span class="p">,</span>
<span class="lineno"> 4</span>     <span class="nt">&quot;response&quot;</span><span class="p">:</span> <span class="p">[{</span>
<span class="lineno"> 5</span>         <span class="nt">&quot;serial&quot;</span><span class="p">:</span> <span class="s2">&quot;[serial number]&quot;</span><span class="p">,</span>
<span class="lineno"> 6</span>         <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;My HomeWizard&quot;</span><span class="p">,</span>
<span class="lineno"> 7</span>         <span class="nt">&quot;online&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="lineno"> 8</span>         <span class="nt">&quot;hops&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="lineno"> 9</span>         <span class="nt">&quot;local&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="lineno">10</span>         <span class="nt">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;[internal ip]&quot;</span>
<span class="lineno">11</span>     <span class="p">}],</span>
<span class="lineno">12</span>     <span class="nt">&quot;cloud&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="lineno">13</span>     <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.4&quot;</span><span class="p">,</span>
<span class="lineno">14</span>     <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ok&quot;</span>
<span class="lineno">15</span> <span class="p">}</span></code></pre></div>

<p>The values you want to keep in mind are <code>session</code>, <code>response/serial</code> and <code>response/host</code>. The <code>response/host</code> variable contains the internal IP of the HomeWizard. This way you could check if the HomeWizard is available using the internal IP address or not. This could make responses faster. To communicate through the HWO system, you need to keep your <code>session</code> and <code>serial</code> variables, because you need it to construct the right URLs.</p>

<p>The next call you want to perform is probably something like <code>https://cloud.homewizard.com/forward/[sessionid]/[serial]/get-sensors</code> where as you can see the <code>session</code> and <code>serial</code> variables are put inside the URL. Also supply the call with the right authentication credentials again, to make sure you are authenticated when performing the call.</p>

<p>The <code>get-sensors</code> part is straight from the <a href="http://cocoa.ninja/posts/HomeWizard-API-calls/">HomeWizard API</a> post and you can use that post to create the rest of your requests, to control your HomeWizard.</p>


  </article>
</div>


<div id="disqus_thread" class="comments">
  <script type="text/javascript">
      var disqus_shortname = 'cocoaninja';

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>


    </div>

    <footer class="footer">
	<div class="container">
		<p class="text-muted">&copy; 2015 - Wim Haanstra</p>
	</div>
</footer>

	<script type="text/javascript" src="/js/jquery-1.11.2.min.js"></script>
	<script type="text/javascript" src="/js/bootstrap.min.js"></script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	
	  ga('create', 'UA-15884210-11', 'auto');
	  ga('send', 'pageview');
	
	</script>
	
  </body>

</html>
