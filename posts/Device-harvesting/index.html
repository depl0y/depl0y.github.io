<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>App harvesting and how would this be solvable</title>
  <meta name="description" content="Yesterday I had a discussion on Twitter with Jonathan Wight (@schwa) on a “bug/new feature” that Steve Streza (@stevestreza) encountered in iOS9. canOpenUrl ...">

  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/main.css">
  
<!--  <link rel="stylesheet" href="/css/main.css"> -->
  <link rel="canonical" href="http://cocoa.ninja/posts/Device-harvesting">
  <link rel="alternate" type="application/rss+xml" title="cocoa.ninja" href="http://cocoa.ninja/feed.xml" />
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
		<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>	    
      <a class="navbar-brand" href="/">
         cocoa.ninja
      </a>
    </div>
  
	  <div class="collapse navbar-collapse">
	      <ul class="nav navbar-nav navbar-right">
		      <li>
			  	<a href="https://twitter.com/depl0y">
					<img src="/img/svg/twitter.svg">
				</a>
	        
			</li>
	     
			<li class="icon  icon--github">
				<a href="https://github.com/depl0y">
					<img src="/img/svg/github.svg">
				</a>
			</li>	 
		
		
			<li class="icon icon--mail">
				<a href="mailto:wim@sortedbits.com">
					<img src="/img/svg/mail.svg">
				</a>
			</li>
			
			<li class="icon icon--so">
				<a href="http://stackoverflow.com/users/69313/wim-haanstra">
					<img src="/img/svg/stackoverflow.svg">
				</a>
			</li>
			
			
			<li class="icon icon--so">
				<a href="skype:wimhaanstra" id="skype_call_wim">
					<img src="/img/svg/skype.svg">
				</a>
			</li>
	  	</ul>
	  </div>
  </div>
</nav>


    <div class="container">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">App harvesting and how would this be solvable</h1>
  </header>
</div>

<div class="post-info">
	<div class="author-avatar">
		<img src="http://www.gravatar.com/avatar/0ec84fc5efb4f0dc7db5df8bf6bb41b9.png">
	</div>
	<div class="details">
		<div class="row">
			<div class="col-md-12 author-name">
				Wim Haanstra
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 post-subtitle">
				This post was created on <span class="post-date">June 10, 2015</span>.
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 tags">
		   		
		   			<span class="tag">blog</span>
		   		
		   			<span class="tag">canOpenUrl</span>
		   		
			</div>
		</div>
	</div>
</div>


<div class="post">
  <article class="post-content">
    
<p>Yesterday I had a discussion on Twitter with <a href="http://twitter.com/schwa">Jonathan Wight (@schwa)</a> on a “bug/new feature” that <a href="http://twitter.com/stevestreza">Steve Streza (@stevestreza)</a> encountered in iOS9. <code>canOpenUrl</code> failed for a call with the scheme <code>tumblr:</code>. I replied to <a href="https://twitter.com/schwa/status/608366858916491265">this</a> saying that this would probably be solved with some sort of UIKit involvement.</p>

<!-- more -->
<p>First, let’s just assume the <code>canOpenUrl</code> failure is actually intended in iOS9.</p>

<p><strong>App Harvesting, what?</strong><br />
App harvesting or whatever you call it is the process of an app trying to determine what other apps are installed on your phone and sending that information the their own or some 3rd party service. Twitter has been known to be doing this. This is clearly an invasion of my privacy, wouldn’t want people to know that next to Telegram, I do still have WhatsApp installed on my phone ;).</p>

<p>So the more I thought about it, the more it sounds solvable using some sort of component handled by UIKit.</p>

<p>So this is just a brain-fart, because I haven’t thought about this for longer that an hour or so, so the solution may be too simple, but I would love to hear why.</p>

<p>At the moment when you set up <code>CFBundleURLTypes</code> your app becomes <em>the</em> app to open URLs with that scheme. Now this seems like a system that is based on good intentions. There is nothing stopping me submitting an app which accepts the same schemes as for example the Twitter or Tumblr app.</p>

<p>So, when 2 apps register the same URL schemes, you actually break the system as it is in place now. Which app should now open up that link you just clicked in Safari (or in any other app for that matter).</p>

<p><strong>So what can we do?</strong><br />
Well to remove the <code>canOpenUrl</code> functionality we actually need Apple to step in and offer us some sheet which you can call from within your application.</p>

<p>For example it would be possible to call up a sheet which shows you all applications that are registered for a certain scheme (<em>pseudo code here, just making this up as I go</em>):</p>

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="lineno">1</span> <span class="k">var</span> <span class="n">success</span> <span class="o">=</span> <span class="n">UIOpenUrlHandler</span><span class="p">.</span><span class="n">openUpSomeUrlOpeningSheet</span><span class="p">(</span><span class="nl">scheme</span><span class="p">:</span> <span class="s">&quot;myscheme:&quot;</span><span class="p">)</span></code></pre></div>

<p>When this code is executed for the first time, iOS should trigger it’s security system and ask the user if it really wants the app to have access to other applications.</p>

<p>This could open up a sheet which shows you all the applications installed for this scheme. Optionally it could return <code>false</code> when there are no applications installed for this scheme or when the user denies access to this information, because returning <code>true</code> could mean you already have that <strong>one</strong> application installed which supports <code>myscheme</code>.</p>

<p>The user selects an app in the sheet and the app is called with the url with the <code>myscheme</code> scheme.</p>

<p>Now this would cause troubles for launcher apps, because it would mean an extra click every time you want your app to open up an external url, so why not ask the user if this is the default app they want to use to open this type of URLs from within this application? The next time you call <code>openUpSomeUrlOpeningSheet</code> it could just run the default app the user selected.</p>

<p><strong>Important</strong><br />
As I said before, there is probably more to think about. But when this is integrated system wide it could elegantly support other browser, mail apps, etc.</p>

  </article>
</div>


<div id="disqus_thread" class="comments">
  <script type="text/javascript">
      var disqus_shortname = 'cocoaninja';

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>


    </div>

    <footer class="footer">
	<div class="container">
		<p class="text-muted">&copy; 2015 - Wim Haanstra</p>
	</div>
</footer>

	<script type="text/javascript" src="/js/jquery-1.11.2.min.js"></script>
	<script type="text/javascript" src="/js/bootstrap.min.js"></script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	
	  ga('create', 'UA-15884210-11', 'auto');
	  ga('send', 'pageview');
	
	</script>
	
  </body>

</html>
