<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Stacked progress bar graph</title>
  <meta name="description" content="Because I got bored the other day, I decided I wanted to build the stacked bar graph you seen in iTunes, but for usage with your iOS apps. I am talking about...">

  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/main.css">
  
<!--  <link rel="stylesheet" href="/css/main.css"> -->
  <link rel="canonical" href="http://cocoa.ninja/posts/stacked-progress-bar-graph">
  <link rel="alternate" type="application/rss+xml" title="cocoa.ninja" href="http://cocoa.ninja/feed.xml" />
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
		<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>	    
      <a class="navbar-brand" href="/">
         cocoa.ninja
      </a>
    </div>
  
	  <div class="collapse navbar-collapse">
	      <ul class="nav navbar-nav navbar-right">
		      <li>
			  	<a href="https://twitter.com/depl0y">
					<img src="/img/svg/twitter.svg">
				</a>
	        
			</li>
	     
			<li class="icon  icon--github">
				<a href="https://github.com/depl0y">
					<img src="/img/svg/github.svg">
				</a>
			</li>	 
		
		
			<li class="icon icon--mail">
				<a href="mailto:wim@sortedbits.com">
					<img src="/img/svg/mail.svg">
				</a>
			</li>
			
			<li class="icon icon--so">
				<a href="http://stackoverflow.com/users/69313/wim-haanstra">
					<img src="/img/svg/stackoverflow.svg">
				</a>
			</li>
			
			
			<li class="icon icon--so">
				<a href="skype:wimhaanstra" id="skype_call_wim">
					<img src="/img/svg/skype.svg">
				</a>
			</li>
	  	</ul>
	  </div>
  </div>
</nav>


    <div class="container">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Stacked progress bar graph</h1>
  </header>
</div>

<div class="post-info">
	<div class="author-avatar">
		<img src="http://www.gravatar.com/avatar/0ec84fc5efb4f0dc7db5df8bf6bb41b9.png">
	</div>
	<div class="details">
		<div class="row">
			<div class="col-md-12 author-name">
				Wim Haanstra
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 post-subtitle">
				This post was created on <span class="post-date">May 27, 2012</span>.
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 tags">
		   		
		   			<span class="tag">objC</span>
		   		
		   			<span class="tag">graph</span>
		   		
			</div>
		</div>
	</div>
</div>


<div class="post">
  <article class="post-content">
    <p>Because I got bored the other day, I decided I wanted to build the stacked bar graph you seen in iTunes, but for usage with your iOS apps. I am talking about this thing:</p>

<p><img class="size-full wp-image-1801 aligncenter" title="Screen Shot 2012-05-27 at 9.28.33 AM" alt="" src="/img/Screen-Shot-2012-05-27-at-9.28.33-AM.png" width="478" height="39" /></p>

<p>There are a few things I do no like about this bar. First the colors of the ‘parts’ of the bar, but this will be customizable. The other thing I did not like is the drop shadow it creates <strong>over</strong> the parts of the bar. So I changed that a little to something I like.
<!-- more --></p>

<p>Keep in mind, this is a work in progress. Memory management is not even there yet (yay for ARC) and it might contain a bug or two, but I will try to make it work as bug-free as possible.</p>

<p>At the bottom of this post is a link to the Github page containing the sample project, sources, images and a more detailed explanation of the interfaces used. This is what I came up with so far.</p>

<p><img class=" wp-image-1804  " title="GraphBar" alt="click to enlarge" src="/img/GraphBar.png" width="131" height="300" /></p>

<p>The bar uses a datasource and a delegate, just as a normal UITableView and should be used in the same manner. I will try to explain the API a bit so you can just plug it in and try it out yourself.</p>

<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="lineno">1</span> <span class="k">@protocol</span> <span class="nc">SBHorizontalBarDelegate</span>
<span class="lineno">2</span> 
<span class="lineno">3</span> <span class="k">@optional</span>
<span class="lineno">4</span> <span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nl">doneDrawing</span><span class="p">:(</span><span class="n">SBHorizontalBar</span><span class="o">*</span><span class="p">)</span> <span class="n">bar</span><span class="p">;</span>
<span class="lineno">5</span> <span class="k">@end</span></code></pre></div>

<p>The delegate currently contains just one method. The method <code>doneDrawing</code> is called when the bar is done drawing all parts and all animation is done. It is optional, but it could be used to chain some things together (for example, showing a legend).</p>

<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="lineno">1</span> <span class="k">@protocol</span> <span class="nc">SBHorizontalBarDataSource</span>
<span class="lineno">2</span> 
<span class="lineno">3</span> <span class="p">-</span> <span class="p">(</span><span class="bp">NSInteger</span><span class="p">)</span> <span class="nf">numberOfItemsInBar:</span><span class="p">(</span><span class="n">SBHorizontalBar</span><span class="o">*</span><span class="p">)</span> <span class="nv">bar</span><span class="p">;</span>
<span class="lineno">4</span> <span class="p">-</span> <span class="p">(</span><span class="n">CGFloat</span><span class="p">)</span> <span class="nf">valueForItem:</span><span class="p">(</span><span class="bp">NSInteger</span><span class="p">)</span> <span class="nv">itemNumber</span> <span class="nf">inBar:</span><span class="p">(</span><span class="n">SBHorizontalBar</span><span class="o">*</span><span class="p">)</span> <span class="nv">bar</span><span class="p">;</span>
<span class="lineno">5</span> <span class="p">-</span> <span class="p">(</span><span class="bp">UIColor</span><span class="o">*</span><span class="p">)</span> <span class="nf">colorForItem:</span><span class="p">(</span><span class="bp">NSInteger</span><span class="p">)</span> <span class="nv">itemNumber</span> <span class="nf">inBar:</span><span class="p">(</span><span class="n">SBHorizontalBar</span><span class="o">*</span><span class="p">)</span> <span class="nv">bar</span><span class="p">;</span>
<span class="lineno">6</span> 
<span class="lineno">7</span> <span class="k">@end</span></code></pre></div>

<p>The datasource has a few simple calls, we’ll start from top to bottom:</p>

<p><code>- (NSInteger) numberOfItemsInBar:(SBHorizontalBar*) bar;</code></p>

<p>This <strong>required</strong> method is called by the bar to receive the total number of ‘parts’ in your bar. This works just like the numberOfRowsInSection: method that is called by an UITableViewController. You need to return the number of parts you want to show.</p>

<p><code>- (CGFloat) valueForItem:(NSInteger) itemNumber inBar:(SBHorizontalBar*) bar;</code></p>

<p>This <strong>required</strong> method will ask your dataSource what value should be assigned to the part with index itemNumber. You will need to return a float value here.</p>

<p><code>- (UIColor*) colorForItem:(NSInteger) itemNumber inBar:(SBHorizontalBar*) bar;</code></p>

<p>This <strong>required</strong> method will ask you what color you would want to use for the part with index itemNumber. You can assign any UIColor here, so you could also work with UIImage objects (which I do in my example project).</p>

<p>I created a public Bitbucket repository for this project, if there is any interest, we could enhance it a bit.</p>

<p><a href="https://bitbucket.org/depl0y/sbframework/src/master/SBFramework/Graphs/SBStackedHorizontalBar">BitBucket repository</a></p>

  </article>
</div>


<div id="disqus_thread" class="comments">
  <script type="text/javascript">
      var disqus_shortname = 'cocoaninja';

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>


    </div>

    <footer class="footer">
	<div class="container">
		<p class="text-muted">&copy; 2015 - Wim Haanstra</p>
	</div>
</footer>

	<script type="text/javascript" src="/js/jquery-1.11.2.min.js"></script>
	<script type="text/javascript" src="/js/bootstrap.min.js"></script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	
	  ga('create', 'UA-15884210-11', 'auto');
	  ga('send', 'pageview');
	
	</script>
	
  </body>

</html>
